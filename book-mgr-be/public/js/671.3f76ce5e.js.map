{"version":3,"file":"js/671.3f76ce5e.js","mappings":"6MAKUA,EAAAA,EAAAA,GAAa,UAAT,QAAI,G,wMAJhBC,EAAAA,EAAAA,IA0CM,aAzCJC,EAAAA,EAAAA,IAwCSC,EAAAA,CAxCAC,SAAUC,EAAAA,SAAO,C,kBACxB,IAsCS,EAtCTH,EAAAA,EAAAA,IAsCSI,EAAAA,CAtCAC,MAAOF,EAAAA,OAAS,UAAY,I,mBACnC,IAGM,CAHMA,EAAAA,QAEaG,EAAAA,EAAAA,IAAAA,IAAAA,KAFP,WAAlBP,EAAAA,EAAAA,IAGM,SAFJQ,GACAP,EAAAA,EAAAA,IAAuBM,OAGzBR,EAAAA,EAAAA,GAuBM,aAtBJE,EAAAA,EAAAA,IAqBUQ,EAAAA,CApBRC,SAAA,GACCC,QAASP,EAAAA,QACT,cAAaA,EAAAA,KACbQ,YAAY,EACZC,OAAQ,CAAAC,EAAAA,gB,CAEQC,UAAQ,SACvB,EAD2BC,SAAQC,YAAM,CACJ,iBAArBD,EAAOE,YAAS,WAAhClB,EAAAA,EAAAA,IAEWmB,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNH,EAAOI,KAAKC,SAAO,yBAEa,WAArBN,EAAOE,YAAS,WAAhClB,EAAAA,EAAAA,IAEWmB,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNH,EAAOM,QAAM,yBAEmB,cAArBP,EAAOE,YAAS,WAAhClB,EAAAA,EAAAA,IAEWmB,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNhB,EAAAA,gBAAgBa,EAAOO,KAAKC,YAAS,yBAEL,YAArBT,EAAOE,WAA4Bd,EAAAA,QACA,iBADM,WACvDJ,EAAAA,EAAAA,IAAqD,K,MAAlD0B,KAAK,eAAgBC,QAAK,GAAEvB,EAAAA,OAAOa,IAAS,KAAE,S,oCAKxCb,EAAAA,Q,iBAAM,WAAvBwB,EAAAA,EAAAA,IAOWC,EAAAA,C,MAPcC,MAAA,uB,mBACvB,IAKgB,EALhB7B,EAAAA,EAAAA,IAKgB8B,EAAAA,CAJNC,QAAS5B,EAAAA,Q,kCAAAA,EAAAA,QAAO,GACvB6B,SAAU,GACVC,MAAO9B,EAAAA,MACP+B,SAAQ/B,EAAAA,S,0ICtCrB,MAAMgC,EAAU,CACd,CAAC,kBAAmB,UACpB,CAAC,YAAa,UACd,CAAC,aAAc,cAGJC,EAAoBC,IAC/B,IAAIhC,EAAQ,GAOZ,OALA8B,EAAQG,SAASC,IACXF,EAAKG,SAASD,EAAK,MACrBlC,EAAQgC,EAAKI,QAAQF,EAAK,GAAIA,EAAK,IACrC,IAEKlC,GAASgC,CAAI,E,cCTtB,MAAM3B,EAAU,CACd,CACEL,MAAO,MACPY,UAAW,gBAEb,CACEZ,MAAO,KACPY,UAAW,UAEb,CACEZ,MAAO,OACPY,UAAW,cAIf,OAAeyB,EAAAA,EAAAA,IAAgB,CAC7BC,MAAO,CAAEC,OAAQC,SACjBC,MAAMH,GACJ,MAAMI,GAAUC,EAAAA,EAAAA,IAAI,GACdf,GAAQe,EAAAA,EAAAA,IAAI,GACZC,GAAOD,EAAAA,EAAAA,IAAI,IACXE,GAAUF,EAAAA,EAAAA,KAAI,GACfL,EAAMC,QACTlC,EAAQyC,KAAK,CACX9C,MAAO,KACPY,UAAW,YAGf,MAAMmC,EAAUC,UACdH,EAAQI,OAAQ,EAChB,MAAMC,QAAYC,EAAAA,GAAAA,KAAST,EAAQO,MAAO,IAC1CJ,EAAQI,OAAQ,GAChBG,EAAAA,EAAAA,IAAOF,GAAKG,SAAQ,EAAGC,MAAQV,KAAMW,EAAG3B,MAAO4B,OAC7CD,EAAEtB,SAASC,IACTA,EAAKjB,OAASc,EAAiBG,EAAKuB,QAAQC,IAAI,IAElDd,EAAKK,MAAQM,EACbI,QAAQR,IAAII,GACZ3B,EAAMqB,MAAQO,CAAC,GACf,GAEJI,EAAAA,EAAAA,KAAU,KACRb,GAAS,IAEX,MAAMc,EAAWC,IACfpB,EAAQO,MAAQa,EAChBf,GAAS,EAELgB,EAASf,OAASgB,UACtB,MAAMd,QAAYC,EAAAA,GAAAA,OAAWa,IAC7BZ,EAAAA,EAAAA,IAAOF,GAAKG,SAAQ,KAClBY,EAAAA,GAAAA,QAAgBC,KAChBnB,GAAS,GACT,EAEJ,MAAO,CACLL,UACAd,QACAgB,OACAvC,UACAwD,UACAhB,UACAsB,gBAAe,KACfJ,SACAxB,OAAQD,EAAMC,OAElB,I,QClEF,MAAM6B,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://book-mgr-fe/./src/views/Log/index.vue","webpack://book-mgr-fe/./src/helpers/log/index.js","webpack://book-mgr-fe/./src/views/Log/index.js","webpack://book-mgr-fe/./src/views/Log/index.vue?684c"],"sourcesContent":["<template>\n  <div>\n    <a-spin :spinning=\"loading\">\n      <a-card :title=\"simple ? '最近的操作日志' : ''\">\n        <div v-if=\"!simple\">\n          <h2>操作日志</h2>\n          <a-divider></a-divider>\n        </div>\n\n        <div>\n          <a-table\n            bordered\n            :columns=\"columns\"\n            :data-source=\"list\"\n            :pagination=\"false\"\n            :scroll=\"{ x: 'max-content' }\"\n          >\n            <template v-slot:bodyCell=\"{ column, record }\">\n              <template v-if=\"column.dataIndex === 'user.account'\">\n                {{ record.user.account }}\n              </template>\n              <template v-if=\"column.dataIndex === 'action'\">\n                {{ record.action }}\n              </template>\n              <template v-if=\"column.dataIndex === 'createdAt'\">\n                {{ formatTimeStamp(record.meta.createdAt) }}\n              </template>\n              <template v-if=\"column.dataIndex === 'actions' && !simple\">\n                <a href=\"javascript:;\" @click=\"remove(record)\">删除</a>\n              </template>\n            </template>\n          </a-table>\n        </div>\n        <flex-end v-if=\"!simple\" style=\"margin-top: 24px\">\n          <a-pagination\n            v-model:current=\"curPage\"\n            :pageSize=\"10\"\n            :total=\"total\"\n            @change=\"setPage\"\n          ></a-pagination>\n        </flex-end>\n      </a-card>\n    </a-spin>\n  </div>\n</template>\n\n<script src=\"./index.js\"></script>\n","const LOG_MAP = [\n  ['/character/list', '获取角色列表'],\n  ['/log/list', '获取日志列表'],\n  ['/user/info', '获取自己的登入信息'],\n];\n\nexport const getLogInfoByPath = (path) => {\n  let title = '';\n\n  LOG_MAP.forEach((item) => {\n    if (path.includes(item[0])) {\n      title = path.replace(item[0], item[1]);\n    }\n  });\n  return title || path;\n};\n","import { defineComponent, onMounted, ref } from 'vue';\nimport { log } from '@/service';\nimport { result, formatTimeStamp } from '@/helpers/utils';\nimport { getLogInfoByPath } from '@/helpers/log';\nimport { message } from 'ant-design-vue';\nconst columns = [\n  {\n    title: '用户名',\n    dataIndex: 'user.account',\n  },\n  {\n    title: '动作',\n    dataIndex: 'action',\n  },\n  {\n    title: '记录时间',\n    dataIndex: 'createdAt',\n  },\n];\n\nexport default defineComponent({\n  props: { simple: Boolean },\n  setup(props) {\n    const curPage = ref(1);\n    const total = ref(0);\n    const list = ref([]);\n    const loading = ref(true);\n    if (!props.simple) {\n      columns.push({\n        title: '操作',\n        dataIndex: 'actions',\n      });\n    }\n    const getList = async () => {\n      loading.value = true;\n      const res = await log.list(curPage.value, 10);\n      loading.value = false;\n      result(res).success(({ data: { list: l, total: t } }) => {\n        l.forEach((item) => {\n          item.action = getLogInfoByPath(item.request.url);\n        });\n        list.value = l;\n        console.log(l);\n        total.value = t;\n      });\n    };\n    onMounted(() => {\n      getList();\n    });\n    const setPage = (page) => {\n      curPage.value = page;\n      getList();\n    };\n    const remove = async ({ _id }) => {\n      const res = await log.remove(_id);\n      result(res).success(() => {\n        message.success(msg);\n        getList();\n      });\n    };\n    return {\n      curPage,\n      total,\n      list,\n      columns,\n      setPage,\n      loading,\n      formatTimeStamp,\n      remove,\n      simple: props.simple,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=b035f07e\"\nimport script from \"./index.js?vue&type=script&lang=js\"\nexport * from \"./index.js?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Alvin\\\\Desktop\\\\图书管理系统\\\\book-mgr-fe\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","_createElementBlock","_createVNode","_component_a_spin","spinning","_ctx","_component_a_card","title","_component_a_divider","_hoisted_2","_component_a_table","bordered","columns","pagination","scroll","x","bodyCell","column","record","dataIndex","_Fragment","key","user","account","action","meta","createdAt","href","onClick","_createBlock","_component_flex_end","style","_component_a_pagination","current","pageSize","total","onChange","LOG_MAP","getLogInfoByPath","path","forEach","item","includes","replace","defineComponent","props","simple","Boolean","setup","curPage","ref","list","loading","push","getList","async","value","res","log","result","success","data","l","t","request","url","console","onMounted","setPage","page","remove","_id","message","msg","formatTimeStamp","__exports__","render"],"sourceRoot":""}