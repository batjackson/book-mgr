"use strict";(self["webpackChunkbook_mgr_fe"]=self["webpackChunkbook_mgr_fe"]||[]).push([[887,852,671],{4354:function(a,t,e){e.r(t),e.d(t,{default:function(){return C}});var n=e(3396),s=e(7139);const l=a=>((0,n.dD)("data-v-4a474112"),a=a(),(0,n.Cn)(),a),o={class:"list"},i={class:"item"},c={class:"count"},u=l((()=>(0,n._)("div",{class:"title"},"书籍",-1))),r={class:"item"},d={class:"count"},p=l((()=>(0,n._)("div",{class:"title"},"用户",-1))),v={class:"item"},m={class:"count"},g=l((()=>(0,n._)("div",{class:"title"},"日志",-1))),f={class:"table-list"},k={class:"left"},_={class:"right"};function w(a,t,e,l,w,b){const I=(0,n.up)("a-card"),h=(0,n.up)("a-spin"),x=(0,n.up)("book"),y=(0,n.up)("log");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(h,{spinning:a.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n._)("div",o,[(0,n._)("div",i,[(0,n._)("div",c,"共 "+(0,s.zw)(a.baseInfo.total.book)+" 本",1),u]),(0,n._)("div",r,[(0,n._)("div",d,"共 "+(0,s.zw)(a.baseInfo.total.user)+" 个",1),p]),(0,n._)("div",v,[(0,n._)("div",m,"共 "+(0,s.zw)(a.baseInfo.total.log)+" 条",1),g])])])),_:1})])),_:1},8,["spinning"]),(0,n._)("div",f,[(0,n._)("div",k,[(0,n.Wm)(x,{simple:""})]),(0,n._)("div",_,[(0,n.Wm)(y,{simple:""})])])])}var b=e(4870),I=e(1192),h=e(1731),x=e(4660),y=e(7671),q=(0,n.aZ)({components:{Book:x["default"],Log:y["default"]},setup(){const a=(0,b.iH)(!0),t=(0,b.iH)({total:{book:0,user:0,log:0}}),e=async()=>{a.value=!0;const e=await I.sI.baseInfo();a.value=!1,(0,h.q6)(e).success((({data:a})=>{t.value=a,console.log(t.value.total.book)}))};return(0,n.bv)((()=>{e()})),{loading:a,baseInfo:t}}}),H=e(89);const W=(0,H.Z)(q,[["render",w],["__scopeId","data-v-4a474112"]]);var C=W},7671:function(a,t,e){e.r(t),e.d(t,{default:function(){return w}});var n=e(3396),s=e(7139);const l={key:0},o=(0,n._)("h2",null,"操作日志",-1),i=["onClick"];function c(a,t,e,c,u,r){const d=(0,n.up)("a-divider"),p=(0,n.up)("a-table"),v=(0,n.up)("a-pagination"),m=(0,n.up)("flex-end"),g=(0,n.up)("a-card"),f=(0,n.up)("a-spin");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(f,{spinning:a.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{title:a.simple?"最近的操作日志":""},{default:(0,n.w5)((()=>[a.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",l,[o,(0,n.Wm)(d)])),(0,n._)("div",null,[(0,n.Wm)(p,{bordered:"",columns:a.columns,"data-source":a.list,pagination:!1,scroll:{x:"max-content"}},{bodyCell:(0,n.w5)((({column:t,record:e})=>["user.account"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)((0,s.zw)(e.user.account),1)],64)):(0,n.kq)("",!0),"action"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)((0,s.zw)(e.action),1)],64)):(0,n.kq)("",!0),"createdAt"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[(0,n.Uk)((0,s.zw)(a.formatTimeStamp(e.meta.createdAt)),1)],64)):(0,n.kq)("",!0),"actions"!==t.dataIndex||a.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("a",{key:3,href:"javascript:;",onClick:t=>a.remove(e)},"删除",8,i))])),_:1},8,["columns","data-source"])]),a.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(m,{key:1,style:{"margin-top":"24px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(v,{current:a.curPage,"onUpdate:current":t[0]||(t[0]=t=>a.curPage=t),pageSize:10,total:a.total,onChange:a.setPage},null,8,["current","total","onChange"])])),_:1}))])),_:1},8,["title"])])),_:1},8,["spinning"])])}e(7658);var u=e(4870),r=e(1192),d=e(1731);const p=[["/character/list","获取角色列表"],["/log/list","获取日志列表"],["/user/info","获取自己的登入信息"]],v=a=>{let t="";return p.forEach((e=>{a.includes(e[0])&&(t=a.replace(e[0],e[1]))})),t||a};var m=e(6842);const g=[{title:"用户名",dataIndex:"user.account"},{title:"动作",dataIndex:"action"},{title:"记录时间",dataIndex:"createdAt"}];var f=(0,n.aZ)({props:{simple:Boolean},setup(a){const t=(0,u.iH)(1),e=(0,u.iH)(0),s=(0,u.iH)([]),l=(0,u.iH)(!0);a.simple||g.push({title:"操作",dataIndex:"actions"});const o=async()=>{l.value=!0;const a=await r.cM.list(t.value,10);l.value=!1,(0,d.q6)(a).success((({data:{list:a,total:t}})=>{a.forEach((a=>{a.action=v(a.request.url)})),s.value=a,console.log(a),e.value=t}))};(0,n.bv)((()=>{o()}));const i=a=>{t.value=a,o()},c=async({_id:a})=>{const t=await r.cM.remove(a);(0,d.q6)(t).success((()=>{m.ZP.success(msg),o()}))};return{curPage:t,total:e,list:s,columns:g,setPage:i,loading:l,formatTimeStamp:d.jH,remove:c,simple:a.simple}}}),k=e(89);const _=(0,k.Z)(f,[["render",c]]);var w=_}}]);
//# sourceMappingURL=887.6805f220.js.map