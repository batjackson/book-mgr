{"version":3,"file":"js/887.6805f220.js","mappings":"iQAIaA,MAAM,Q,GACJA,MAAM,Q,GACJA,MAAM,S,UACXC,EAAAA,EAAAA,GAA2B,OAAtBD,MAAM,SAAQ,MAAE,K,GAElBA,MAAM,Q,GACJA,MAAM,S,UACXC,EAAAA,EAAAA,GAA2B,OAAtBD,MAAM,SAAQ,MAAE,K,GAElBA,MAAM,Q,GACJA,MAAM,S,UACXC,EAAAA,EAAAA,GAA2B,OAAtBD,MAAM,SAAQ,MAAE,K,GAKxBA,MAAM,c,GACJA,MAAM,Q,GAGNA,MAAM,S,+HAvBfE,EAAAA,EAAAA,IA2BM,aA1BJC,EAAAA,EAAAA,IAiBSC,EAAAA,CAjBAC,SAAUC,EAAAA,SAAO,C,kBACxB,IAeS,EAfTH,EAAAA,EAAAA,IAeSI,EAAAA,KAAAA,C,kBAdP,IAaM,EAbNN,EAAAA,EAAAA,GAaM,MAbNO,EAaM,EAZJP,EAAAA,EAAAA,GAGM,MAHNQ,EAGM,EAFJR,EAAAA,EAAAA,GAAsD,MAAtDS,EAAmB,MAAE,QAAGJ,EAAAA,SAASK,MAAMC,MAAO,KAAE,GAChDC,KAEFZ,EAAAA,EAAAA,GAGM,MAHNa,EAGM,EAFJb,EAAAA,EAAAA,GAAsD,MAAtDc,EAAmB,MAAE,QAAGT,EAAAA,SAASK,MAAMK,MAAO,KAAE,GAChDC,KAEFhB,EAAAA,EAAAA,GAGM,MAHNiB,EAGM,EAFJjB,EAAAA,EAAAA,GAAqD,MAArDkB,EAAmB,MAAE,QAAGb,EAAAA,SAASK,MAAMS,KAAM,KAAE,GAC/CC,S,+BAKRpB,EAAAA,EAAAA,GAOM,MAPNqB,EAOM,EANJrB,EAAAA,EAAAA,GAEM,MAFNsB,EAEM,EADJpB,EAAAA,EAAAA,IAAoBqB,EAAAA,CAAdC,OAAA,QAERxB,EAAAA,EAAAA,GAEM,MAFNyB,EAEM,EADJvB,EAAAA,EAAAA,IAAkBwB,EAAAA,CAAbF,OAAA,U,uDCpBb,GAAeG,EAAAA,EAAAA,IAAgB,CAC7BC,WAAY,CACVC,KAAI,aAACC,IAAGA,EAAAA,YAEVC,QACE,MAAMC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAWD,EAAAA,EAAAA,IAAI,CACnBvB,MAAO,CACLC,KAAM,EACNI,KAAM,EACNI,IAAI,KAIFgB,EAAcC,UAClBJ,EAAQK,OAAQ,EAChB,MAAMC,QAAYC,EAAAA,GAAAA,WAClBP,EAAQK,OAAO,GACfG,EAAAA,EAAAA,IAAOF,GAAKG,SAAQ,EAAGC,WACrBR,EAASG,MAAQK,EACjBC,QAAQxB,IAAIe,EAASG,MAAM3B,MAAMC,KAAK,GACtC,EAOJ,OAJAiC,EAAAA,EAAAA,KAAU,KACRT,GAAa,IAGR,CACLH,UACAE,WAEJ,I,QC9BF,MAAMW,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O,+GCJU9C,EAAAA,EAAAA,GAAa,UAAT,QAAI,G,wMAJhBC,EAAAA,EAAAA,IA0CM,aAzCJC,EAAAA,EAAAA,IAwCSC,EAAAA,CAxCAC,SAAUC,EAAAA,SAAO,C,kBACxB,IAsCS,EAtCTH,EAAAA,EAAAA,IAsCSI,EAAAA,CAtCAyC,MAAO1C,EAAAA,OAAS,UAAY,I,mBACnC,IAGM,CAHMA,EAAAA,QAEa2C,EAAAA,EAAAA,IAAAA,IAAAA,KAFP,WAAlB/C,EAAAA,EAAAA,IAGM,SAFJO,GACAN,EAAAA,EAAAA,IAAuB8C,OAGzBhD,EAAAA,EAAAA,GAuBM,aAtBJE,EAAAA,EAAAA,IAqBU+C,EAAAA,CApBRC,SAAA,GACCC,QAAS9C,EAAAA,QACT,cAAaA,EAAAA,KACb+C,YAAY,EACZC,OAAQ,CAAAC,EAAAA,gB,CAEQC,UAAQ,SACvB,EAD2BC,SAAQC,YAAM,CACJ,iBAArBD,EAAOE,YAAS,WAAhCzD,EAAAA,EAAAA,IAEW0D,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNH,EAAO1C,KAAK8C,SAAO,yBAEa,WAArBL,EAAOE,YAAS,WAAhCzD,EAAAA,EAAAA,IAEW0D,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNH,EAAOK,QAAM,yBAEmB,cAArBN,EAAOE,YAAS,WAAhCzD,EAAAA,EAAAA,IAEW0D,EAAAA,GAAAA,CAAAC,IAAAA,GAAA,mBADNvD,EAAAA,gBAAgBoD,EAAOM,KAAKC,YAAS,yBAEL,YAArBR,EAAOE,WAA4BrD,EAAAA,QACA,iBADM,WACvDJ,EAAAA,EAAAA,IAAqD,K,MAAlDgE,KAAK,eAAgBC,QAAK,GAAE7D,EAAAA,OAAOoD,IAAS,KAAE,S,oCAKxCpD,EAAAA,Q,iBAAM,WAAvB8D,EAAAA,EAAAA,IAOWC,EAAAA,C,MAPcC,MAAA,uB,mBACvB,IAKgB,EALhBnE,EAAAA,EAAAA,IAKgBoE,EAAAA,CAJNC,QAASlE,EAAAA,Q,kCAAAA,EAAAA,QAAO,GACvBmE,SAAU,GACV9D,MAAOL,EAAAA,MACPoE,SAAQpE,EAAAA,S,0ICtCrB,MAAMqE,EAAU,CACd,CAAC,kBAAmB,UACpB,CAAC,YAAa,UACd,CAAC,aAAc,cAGJC,EAAoBC,IAC/B,IAAI7B,EAAQ,GAOZ,OALA2B,EAAQG,SAASC,IACXF,EAAKG,SAASD,EAAK,MACrB/B,EAAQ6B,EAAKI,QAAQF,EAAK,GAAIA,EAAK,IACrC,IAEK/B,GAAS6B,CAAI,E,cCTtB,MAAMzB,EAAU,CACd,CACEJ,MAAO,MACPW,UAAW,gBAEb,CACEX,MAAO,KACPW,UAAW,UAEb,CACEX,MAAO,OACPW,UAAW,cAIf,OAAe/B,EAAAA,EAAAA,IAAgB,CAC7BsD,MAAO,CAAEzD,OAAQ0D,SACjBnD,MAAMkD,GACJ,MAAME,GAAUlD,EAAAA,EAAAA,IAAI,GACdvB,GAAQuB,EAAAA,EAAAA,IAAI,GACZmD,GAAOnD,EAAAA,EAAAA,IAAI,IACXD,GAAUC,EAAAA,EAAAA,KAAI,GACfgD,EAAMzD,QACT2B,EAAQkC,KAAK,CACXtC,MAAO,KACPW,UAAW,YAGf,MAAM4B,EAAUlD,UACdJ,EAAQK,OAAQ,EAChB,MAAMC,QAAYnB,EAAAA,GAAAA,KAASgE,EAAQ9C,MAAO,IAC1CL,EAAQK,OAAQ,GAChBG,EAAAA,EAAAA,IAAOF,GAAKG,SAAQ,EAAGC,MAAQ0C,KAAMG,EAAG7E,MAAO8E,OAC7CD,EAAEV,SAASC,IACTA,EAAKhB,OAASa,EAAiBG,EAAKW,QAAQC,IAAI,IAElDN,EAAK/C,MAAQkD,EACb5C,QAAQxB,IAAIoE,GACZ7E,EAAM2B,MAAQmD,CAAC,GACf,GAEJ5C,EAAAA,EAAAA,KAAU,KACR0C,GAAS,IAEX,MAAMK,EAAWC,IACfT,EAAQ9C,MAAQuD,EAChBN,GAAS,EAELO,EAASzD,OAAS0D,UACtB,MAAMxD,QAAYnB,EAAAA,GAAAA,OAAW2E,IAC7BtD,EAAAA,EAAAA,IAAOF,GAAKG,SAAQ,KAClBsD,EAAAA,GAAAA,QAAgBC,KAChBV,GAAS,GACT,EAEJ,MAAO,CACLH,UACAzE,QACA0E,OACAjC,UACAwC,UACA3D,UACAiE,gBAAe,KACfJ,SACArE,OAAQyD,EAAMzD,OAElB,I,QClEF,MAAMqB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://book-mgr-fe/./src/views/Dashboard/index.vue","webpack://book-mgr-fe/./src/views/Dashboard/index.js","webpack://book-mgr-fe/./src/views/Dashboard/index.vue?5160","webpack://book-mgr-fe/./src/views/Log/index.vue","webpack://book-mgr-fe/./src/helpers/log/index.js","webpack://book-mgr-fe/./src/views/Log/index.js","webpack://book-mgr-fe/./src/views/Log/index.vue?684c"],"sourcesContent":["<template>\n  <div>\n    <a-spin :spinning=\"loading\">\n      <a-card>\n        <div class=\"list\">\n          <div class=\"item\">\n            <div class=\"count\">共 {{ baseInfo.total.book }} 本</div>\n            <div class=\"title\">书籍</div>\n          </div>\n          <div class=\"item\">\n            <div class=\"count\">共 {{ baseInfo.total.user }} 个</div>\n            <div class=\"title\">用户</div>\n          </div>\n          <div class=\"item\">\n            <div class=\"count\">共 {{ baseInfo.total.log }} 条</div>\n            <div class=\"title\">日志</div>\n          </div>\n        </div>\n      </a-card>\n    </a-spin>\n    <div class=\"table-list\">\n      <div class=\"left\">\n        <book simple></book>\n      </div>\n      <div class=\"right\">\n        <log simple></log>\n      </div>\n    </div>\n  </div>\n</template>\n<script src=\"./index.js\"></script>\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>\n","import { defineComponent, ref, onMounted } from 'vue';\nimport { dashboard } from '@/service';\nimport { result } from '@/helpers/utils';\nimport Book from '@/views/Books/index.vue'\nimport Log from '@/views/Log/index.vue'\nexport default defineComponent({\n  components: {\n    Book,Log\n  },\n  setup() {\n    const loading = ref(true)\n    const baseInfo = ref({\n      total: {\n        book: 0,\n        user: 0,\n        log:0\n      }\n    });\n\n    const getBaseInfo = async () => {\n      loading.value = true\n      const res = await dashboard.baseInfo();\n      loading.value =false\n      result(res).success(({ data }) => {\n        baseInfo.value = data;\n        console.log(baseInfo.value.total.book);\n      });\n    };\n\n    onMounted(() => {\n      getBaseInfo();\n    });\n\n    return {\n      loading,\n      baseInfo,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=4a474112&scoped=true\"\nimport script from \"./index.js?vue&type=script&lang=js\"\nexport * from \"./index.js?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=4a474112&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\Alvin\\\\Desktop\\\\图书管理系统\\\\book-mgr-fe\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4a474112\"]])\n\nexport default __exports__","<template>\n  <div>\n    <a-spin :spinning=\"loading\">\n      <a-card :title=\"simple ? '最近的操作日志' : ''\">\n        <div v-if=\"!simple\">\n          <h2>操作日志</h2>\n          <a-divider></a-divider>\n        </div>\n\n        <div>\n          <a-table\n            bordered\n            :columns=\"columns\"\n            :data-source=\"list\"\n            :pagination=\"false\"\n            :scroll=\"{ x: 'max-content' }\"\n          >\n            <template v-slot:bodyCell=\"{ column, record }\">\n              <template v-if=\"column.dataIndex === 'user.account'\">\n                {{ record.user.account }}\n              </template>\n              <template v-if=\"column.dataIndex === 'action'\">\n                {{ record.action }}\n              </template>\n              <template v-if=\"column.dataIndex === 'createdAt'\">\n                {{ formatTimeStamp(record.meta.createdAt) }}\n              </template>\n              <template v-if=\"column.dataIndex === 'actions' && !simple\">\n                <a href=\"javascript:;\" @click=\"remove(record)\">删除</a>\n              </template>\n            </template>\n          </a-table>\n        </div>\n        <flex-end v-if=\"!simple\" style=\"margin-top: 24px\">\n          <a-pagination\n            v-model:current=\"curPage\"\n            :pageSize=\"10\"\n            :total=\"total\"\n            @change=\"setPage\"\n          ></a-pagination>\n        </flex-end>\n      </a-card>\n    </a-spin>\n  </div>\n</template>\n\n<script src=\"./index.js\"></script>\n","const LOG_MAP = [\n  ['/character/list', '获取角色列表'],\n  ['/log/list', '获取日志列表'],\n  ['/user/info', '获取自己的登入信息'],\n];\n\nexport const getLogInfoByPath = (path) => {\n  let title = '';\n\n  LOG_MAP.forEach((item) => {\n    if (path.includes(item[0])) {\n      title = path.replace(item[0], item[1]);\n    }\n  });\n  return title || path;\n};\n","import { defineComponent, onMounted, ref } from 'vue';\nimport { log } from '@/service';\nimport { result, formatTimeStamp } from '@/helpers/utils';\nimport { getLogInfoByPath } from '@/helpers/log';\nimport { message } from 'ant-design-vue';\nconst columns = [\n  {\n    title: '用户名',\n    dataIndex: 'user.account',\n  },\n  {\n    title: '动作',\n    dataIndex: 'action',\n  },\n  {\n    title: '记录时间',\n    dataIndex: 'createdAt',\n  },\n];\n\nexport default defineComponent({\n  props: { simple: Boolean },\n  setup(props) {\n    const curPage = ref(1);\n    const total = ref(0);\n    const list = ref([]);\n    const loading = ref(true);\n    if (!props.simple) {\n      columns.push({\n        title: '操作',\n        dataIndex: 'actions',\n      });\n    }\n    const getList = async () => {\n      loading.value = true;\n      const res = await log.list(curPage.value, 10);\n      loading.value = false;\n      result(res).success(({ data: { list: l, total: t } }) => {\n        l.forEach((item) => {\n          item.action = getLogInfoByPath(item.request.url);\n        });\n        list.value = l;\n        console.log(l);\n        total.value = t;\n      });\n    };\n    onMounted(() => {\n      getList();\n    });\n    const setPage = (page) => {\n      curPage.value = page;\n      getList();\n    };\n    const remove = async ({ _id }) => {\n      const res = await log.remove(_id);\n      result(res).success(() => {\n        message.success(msg);\n        getList();\n      });\n    };\n    return {\n      curPage,\n      total,\n      list,\n      columns,\n      setPage,\n      loading,\n      formatTimeStamp,\n      remove,\n      simple: props.simple,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=b035f07e\"\nimport script from \"./index.js?vue&type=script&lang=js\"\nexport * from \"./index.js?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Alvin\\\\Desktop\\\\图书管理系统\\\\book-mgr-fe\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_a_spin","spinning","_ctx","_component_a_card","_hoisted_1","_hoisted_2","_hoisted_3","total","book","_hoisted_4","_hoisted_5","_hoisted_6","user","_hoisted_7","_hoisted_8","_hoisted_9","log","_hoisted_10","_hoisted_11","_hoisted_12","_component_book","simple","_hoisted_13","_component_log","defineComponent","components","Book","Log","setup","loading","ref","baseInfo","getBaseInfo","async","value","res","dashboard","result","success","data","console","onMounted","__exports__","render","title","_component_a_divider","_component_a_table","bordered","columns","pagination","scroll","x","bodyCell","column","record","dataIndex","_Fragment","key","account","action","meta","createdAt","href","onClick","_createBlock","_component_flex_end","style","_component_a_pagination","current","pageSize","onChange","LOG_MAP","getLogInfoByPath","path","forEach","item","includes","replace","props","Boolean","curPage","list","push","getList","l","t","request","url","setPage","page","remove","_id","message","msg","formatTimeStamp"],"sourceRoot":""}