"use strict";(self["webpackChunkbook_mgr_fe"]=self["webpackChunkbook_mgr_fe"]||[]).push([[671],{7671:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var n=a(3396),l=a(7139);const c={key:0},i=(0,n._)("h2",null,"操作日志",-1),o=["onClick"];function s(e,t,a,s,r,u){const d=(0,n.up)("a-divider"),p=(0,n.up)("a-table"),m=(0,n.up)("a-pagination"),g=(0,n.up)("flex-end"),k=(0,n.up)("a-card"),v=(0,n.up)("a-spin");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(v,{spinning:e.loading},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{title:e.simple?"最近的操作日志":""},{default:(0,n.w5)((()=>[e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",c,[i,(0,n.Wm)(d)])),(0,n._)("div",null,[(0,n.Wm)(p,{bordered:"",columns:e.columns,"data-source":e.list,pagination:!1,scroll:{x:"max-content"}},{bodyCell:(0,n.w5)((({column:t,record:a})=>["user.account"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)((0,l.zw)(a.user.account),1)],64)):(0,n.kq)("",!0),"action"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)((0,l.zw)(a.action),1)],64)):(0,n.kq)("",!0),"createdAt"===t.dataIndex?((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[(0,n.Uk)((0,l.zw)(e.formatTimeStamp(a.meta.createdAt)),1)],64)):(0,n.kq)("",!0),"actions"!==t.dataIndex||e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("a",{key:3,href:"javascript:;",onClick:t=>e.remove(a)},"删除",8,o))])),_:1},8,["columns","data-source"])]),e.simple?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(g,{key:1,style:{"margin-top":"24px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{current:e.curPage,"onUpdate:current":t[0]||(t[0]=t=>e.curPage=t),pageSize:10,total:e.total,onChange:e.setPage},null,8,["current","total","onChange"])])),_:1}))])),_:1},8,["title"])])),_:1},8,["spinning"])])}a(7658);var r=a(4870),u=a(1192),d=a(1731);const p=[["/character/list","获取角色列表"],["/log/list","获取日志列表"],["/user/info","获取自己的登入信息"]],m=e=>{let t="";return p.forEach((a=>{e.includes(a[0])&&(t=e.replace(a[0],a[1]))})),t||e};var g=a(6842);const k=[{title:"用户名",dataIndex:"user.account"},{title:"动作",dataIndex:"action"},{title:"记录时间",dataIndex:"createdAt"}];var v=(0,n.aZ)({props:{simple:Boolean},setup(e){const t=(0,r.iH)(1),a=(0,r.iH)(0),l=(0,r.iH)([]),c=(0,r.iH)(!0);e.simple||k.push({title:"操作",dataIndex:"actions"});const i=async()=>{c.value=!0;const e=await u.cM.list(t.value,10);c.value=!1,(0,d.q6)(e).success((({data:{list:e,total:t}})=>{e.forEach((e=>{e.action=m(e.request.url)})),l.value=e,console.log(e),a.value=t}))};(0,n.bv)((()=>{i()}));const o=e=>{t.value=e,i()},s=async({_id:e})=>{const t=await u.cM.remove(e);(0,d.q6)(t).success((()=>{g.ZP.success(msg),i()}))};return{curPage:t,total:a,list:l,columns:k,setPage:o,loading:c,formatTimeStamp:d.jH,remove:s,simple:e.simple}}}),f=a(89);const w=(0,f.Z)(v,[["render",s]]);var x=w}}]);
//# sourceMappingURL=671.3f76ce5e.js.map